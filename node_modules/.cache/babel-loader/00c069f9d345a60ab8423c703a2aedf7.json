{"ast":null,"code":"import _regeneratorRuntime from \"/Users/farhanansari/Code/ui-library/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/farhanansari/Code/ui-library/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { getFormattedLatLongString } from './heremapsLatLongConversion';\nexport var getHereMapsDataForPath = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(props, waypoints) {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            return _context2.abrupt(\"return\", new Promise(function (resolve, reject) {\n              var subPolylineLatngs = [];\n\n              var onSuccess = function onSuccess(response) {\n                var route = response.routes[0];\n\n                if (route) {\n                  addRouteOnPath(route);\n                } else {\n                  reject(subPolylineLatngs);\n                }\n              };\n\n              var onError = function onError(error) {\n                console.error('Error while fetching Here maps data', error);\n                reject(subPolylineLatngs);\n              };\n\n              var addRouteOnPath = function addRouteOnPath(route) {\n                var _route$sections;\n\n                route === null || route === void 0 ? void 0 : (_route$sections = route.sections) === null || _route$sections === void 0 ? void 0 : _route$sections.forEach(function (section) {\n                  var _linestring$$;\n\n                  var linestring = props.heremapsObject.geo.LineString.fromFlexiblePolyline(section.polyline);\n                  var arrayWithout0 = linestring === null || linestring === void 0 ? void 0 : (_linestring$$ = linestring.$) === null || _linestring$$ === void 0 ? void 0 : _linestring$$.filter(function (num) {\n                    return num !== 0;\n                  });\n                  var finalArray = [];\n                  arrayWithout0.forEach(function (_, index, array) {\n                    if (index % 2 === 0) {\n                      finalArray.push(array.slice(index, index + 2));\n                    }\n                  });\n                  finalArray.forEach(function (point) {\n                    subPolylineLatngs.push(point);\n                  });\n                });\n                resolve(subPolylineLatngs);\n              };\n\n              var origin = getFormattedLatLongString(waypoints[0]);\n              var destination = getFormattedLatLongString(waypoints[waypoints.length - 1]);\n              var formattedWaypoints = waypoints.map(function (obj) {\n                return getFormattedLatLongString(obj);\n              });\n              var routingParams = {\n                origin: origin,\n                via: new props.heremapsObject.service.Url.MultiValueQueryParameter(formattedWaypoints),\n                destination: destination,\n                routingMode: 'fast',\n                transportMode: 'truck',\n                \"return\": 'polyline'\n              };\n              var platform = new props.heremapsObject.service.Platform({\n                apikey: props.heremapsApiKey\n              });\n              var router = platform.getRoutingService(null, 8);\n              setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.next = 2;\n                        return router.calculateRoute(routingParams, onSuccess, onError);\n\n                      case 2:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              })), 1000);\n            }));\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function getHereMapsDataForPath(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();","map":{"version":3,"sources":["/Users/farhanansari/Code/ui-library/src/components/atoms/Map/utils/HereMapsIntegration/heremapsCall.tsx"],"names":["getFormattedLatLongString","getHereMapsDataForPath","props","waypoints","Promise","resolve","reject","subPolylineLatngs","onSuccess","response","route","routes","addRouteOnPath","onError","error","console","sections","forEach","section","linestring","heremapsObject","geo","LineString","fromFlexiblePolyline","polyline","arrayWithout0","$","filter","num","finalArray","_","index","array","push","slice","point","origin","destination","length","formattedWaypoints","map","obj","routingParams","via","service","Url","MultiValueQueryParameter","routingMode","transportMode","platform","Platform","apikey","heremapsApiKey","router","getRoutingService","setTimeout","calculateRoute"],"mappings":"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","sourcesContent":["import { getFormattedLatLongString } from './heremapsLatLongConversion';\n\nexport const getHereMapsDataForPath = async (props: any, waypoints: any) => {\n  return new Promise<any[]>((resolve, reject) => {\n    const subPolylineLatngs: any[] = [];\n\n    const onSuccess = (response: { routes: any[] }) => {\n      const route = response.routes[0];\n      if (route) {\n        addRouteOnPath(route);\n      } else {\n        reject(subPolylineLatngs);\n      }\n    };\n\n    const onError = (error: any) => {\n      console.error('Error while fetching Here maps data', error);\n      reject(subPolylineLatngs);\n    };\n\n    const addRouteOnPath = (route: any) => {\n      route?.sections?.forEach((section: any) => {\n        const linestring = props.heremapsObject.geo.LineString.fromFlexiblePolyline(section.polyline);\n        const arrayWithout0 = linestring?.$?.filter((num: number) => num !== 0);\n        const finalArray: any[] = [];\n\n      \n        arrayWithout0.forEach((_: any, index: number, array: string | any[]) => {\n          if (index % 2 === 0) {\n              finalArray.push(array.slice(index, index + 2));\n          }\n        });\n        \n        finalArray.forEach((point: any) => {\n          subPolylineLatngs.push(point);\n        });\n      });\n\n      resolve(subPolylineLatngs);\n    };\n\n    const origin = getFormattedLatLongString(waypoints[0]);\n    const destination = getFormattedLatLongString(waypoints[waypoints.length - 1]);\n    const formattedWaypoints = waypoints.map((obj: any) => getFormattedLatLongString(obj));\n\n    const routingParams = {\n      origin,\n      via: new props.heremapsObject.service.Url.MultiValueQueryParameter(formattedWaypoints),\n      destination,\n      routingMode: 'fast',\n      transportMode: 'truck',\n      return: 'polyline',\n    };\n\n    const platform = new props.heremapsObject.service.Platform({\n      apikey: props.heremapsApiKey,\n    });\n\n    const router = platform.getRoutingService(null, 8);\n\n    setTimeout(async () => {\n      await router.calculateRoute(routingParams, onSuccess, onError);\n    }, 1000);\n  });\n};\n"]},"metadata":{},"sourceType":"module"}