@model CreditSale.MVC.Models.ShippmentModel

@{
    Layout = null;
    var CurrentCulture = System.Threading.Thread.CurrentThread.CurrentCulture.TwoLetterISOLanguageName;
    var PublishUrl = SharedAssets.Helpers.SessionHelper.GetXMLConfigData("CreditSale_PublishUrl");
    var barcode = Model.Item.Barcode;
    string ShipmentTitle = @GeneralResource.ShipmentPolicyTitle;
    if (Model.Item.Barcode.Contains("RHB"))
        ShipmentTitle = "باقات مُسبقة الدفع";
    else if (Model.Item.RequestTypeId == 2)
        ShipmentTitle = "مسترجعات التجارة الالكترونية";

    string contentType = Model.Item.IsCOD ? (CurrentCulture == "en" ? "Cash On Delivery" : "دفع عند الاستلام") : (CurrentCulture == "en" ? "Prepaid" : "مسبقة الدفع");
}


<html>
<head>
    <style>
        img {
            -webkit-print-color-adjust: exact;
        }

        .table-report {
            border: 1px solid #333;
            width: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 10px;
            color: #1b4685;
        }

            .table-report tr th, .table-report tr td {
                border: 1px solid #333;
                padding: 5px 3px;
            }

        .border-td {
            border-right: 0px;
            border-left: 0px;
        }

        .border-left {
            border-left: 0px;
        }

        .border-right {
            border-right: 0px;
        }

        #PrintBody {
            padding: 0;
            margin: 0px 0px 0px 0px;
        }

        /*20190408 according to osama mail 'RE: Test status' all policy is black*/
        p, span.pull-left, span.pull-right, td {
            color: #000 !important;
        }
    </style>
    <meta charset="UTF-8">
    <style>
        .table-top th,
        .table-top td {
            border: 0px !important;
        }

        .table-top tbody {
            text-align: right;
        }

            .table-top tbody td {
                padding: 0;
            }

        body {
            direction: rtl;
        }

        .header-table, .print-header {
            display: none;
        }


        * {
            overflow-y: visible !important;
        }

        body {
            padding-top: 0px;
        }

        table {
            width: 100%;
        }

        .repeated-head {
            border-right: 2px #666 solid !important;
            border-top: 2px #666 solid;
            border-bottom: 2px #666 solid !important;
        }

        table th, table td {
            border-left: 2px #666 solid !important;
        }

        table tbody tr {
            border-right: 2px #666 solid !important;
            border-bottom: 2px #666 solid !important;
            border-top: 2px #666 solid !important;
        }

        .header-table {
            display: table-row;
            border: 0px transparent none !important;
        }

            .header-table table {
                width: 100%;
                border: 0px transparent none;
            }

            .header-table th {
                border: 0px transparent none !important;
            }

            .header-table span {
                display: block;
                padding-bottom: 5px;
            }

        * {
            overflow: visible !important;
        }

        .table-bottom {
            margin-top: 20px;
        }

        .width-full {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            display: table-header-group !important;
        }

        tfoot {
            display: table-header-group !important;
        }

        td {
            text-align: center;
        }


        * {
            background-color: transparent !important;
            -webkit-print-color-adjust: exact;
        }
    </style>
</head>
<body>
    <div id="PrintBody">
        <table border="0" style="width:100%">
            <tr>
                <td>
                    <p><svg id="BarcodePlaceHolder"></svg></p>


                </td>
                <td align="right">
                    <img src="@PublishUrl/Content/img/login-logo.png" style="width: 130px; height:104px;" />

                    <p style="margin: 0 !important;">@ShipmentTitle</p>
                </td>
            </tr>
        </table>
        <table class="table-report">
            <thead>
                <tr>
                    <th colspan="3">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyTo</span>
                        <span class="pull-right">To</span>
                    </th>
                    <th colspan="3">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyContentDiscription</span>
                        <span class="pull-right">Contents</span>
                    </th>
                    <th>
                        <span class="pull-left">@GeneralResource.ShippmentPolicyDescription</span>
                        <span class="pull-right">Description</span>
                    </th>
                    <th colspan="3">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyFrom</span>
                        <span class="pull-right">From</span>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="3">
                        <span class="pull-left">البلد</span>
                        <span class="pull-right">Country</span>
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.IsInternal)
                            {
                                <text>السعودية</text>
                            }
                            else
                            {
                                @Model.CustomerAddress.NameArParent
                            }
                        </P>
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.IsInternal)
                            {
                                <text>Saudi Arabia</text>
                            }
                            else
                            {
                                @Model.CustomerAddress.NameEnParent
                            }
                        </P>
                    </td>
                    <td style="border-left :0px">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyFood</span>
                    </td>
                    <td style="border-left:0px; border-right: 0px">
                        @if (Model.IsFood == true)
                        {
                            <input type="checkbox" id="inputUnchecked2" checked />
                        }
                        else
                        {
                            <input type="checkbox" id="inputUnchecked2" />
                        }
                    </td>
                    <td style="border-right:0px"><span class="pull-right">Food</span></td>
                    <td rowspan="9" width="200px">@Model.Item.ContentDesc</td>
                    <td colspan="3">
                        <span class="pull-left">@GeneralResource.ShippmentPolicySaudiArabia</span>
                        <span class="pull-right">Saudi Arabia</span>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <span class="pull-left">المدينة</span>
                        <span class="pull-right">City</span>
                        <P style="text-align:center; color:#973102">
                            @*@if (Model.Item.AddressType != 2) @20190311 we don't know why this condition was here, but anyway we have
                        the national city name if location isnot -1
                    {*@
                            @Model.CustomerAddress.NameAr
                            @*var ttmp = Model.CustomerAddress.NameAr + "   " + Model.CustomerAddress.NameEn;
                    @ttmp*@
                            @*}*@
                        </P>
                        <P style="text-align:center; color:#973102">
                            @*@if (Model.Item.AddressType != 2)     @20190311
                    {*@
                            @Model.CustomerAddress.NameEn
                            @*}*@
                        </P>
                    </td>
                    <td style="border-left :0px">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyClothes</span>
                    </td>
                    <td style="border-left:0px; border-right: 0px">
                        @if (Model.IsClothes == true)
                        {
                            <input type="checkbox" id="inputUnchecked2" checked />
                        }
                        else
                        {
                            <input type="checkbox" id="inputUnchecked2" />
                        }
                    </td>
                    <td style="border-right:0px"><span class="pull-right">Clothes</span></td>
                    <td colspan="3">
                        <span class="pull-left">المدينه</span>
                        <span class="pull-right">City</span>
                        <P style="text-align:center; color:#973102">
                            @Model.SenderAddress.NameAr
                        </P>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <span class="pull-left">اسم المرسل إليه</span>
                        <span class="pull-right">Receiver Name</span>
                        <P style="text-align:center; color:#973102">@Model.Item.FullName</P>
                    </td>
                    <td style="border-left :0px">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyMedical</span>
                    </td>
                    <td style="border-left:0px; border-right: 0px">
                        @if (Model.IsMedicalDeices == true)
                        {
                            <input type="checkbox" id="inputUnchecked2" checked />
                        }
                        else
                        {
                            <input type="checkbox" id="inputUnchecked2" />
                        }
                    </td>
                    <td style="border-right:0px"><span class="pull-right">Medical Equipments</span></td>
                    <td colspan="3">
                        <span class="pull-left">اسم المرسل منه</span>
                        <span class="pull-right">Sender Name</span>
                        <P style="text-align:center; color:#973102">
                            @Model.SenderName
                        </P>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <span class="pull-left">العنوان</span>

                        <span class="pull-right">Address</span>
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.AddressType == 6 && !string.IsNullOrEmpty(Model.Item.District))
                            {
                                string districtName = String.Concat("الحي: ", Model.Item.District);
                                @districtName
                            }
                            else if (Model.Item.IsInternal)     //@20190311 hashed Model.Item.AddressType != 2 &&
                            {
                                @Model.CustomerAddress.NameAr
                                if (Model.Item.ParcelStationID != 0 && Model.Item.AddressType == 3)
                                {
                                    <span> - </span>
                                    @Model.ParcelStationName
                                }
                                else if (Model.Item.OfficeID != 0 && Model.Item.AddressType == 4)
                                {
                                    <span> - @GeneralResource.GeneralOffice :  </span>
                                    @Model.OfficeName
                                }
                            }
                            else if (!Model.Item.IsInternal)
                            {
                                @Model.Item.InternationalRestrict
                            }
                        </P>
                    </td>
                    <td style="border-left :0px">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyElectrical</span>
                    </td>
                    <td style="border-left:0px; border-right: 0px">
                        @if (Model.IsElectric == true)
                        {
                            <input type="checkbox" id="inputUnchecked2" checked />
                        }
                        else
                        {
                            <input type="checkbox" id="inputUnchecked2" />
                        }
                    </td>
                    <td style="border-right:0px"><span class="pull-right">Electrical Appliances</span></td>
                    <td colspan="3">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyCommercialRecordOR700</span>
                        <span class="pull-right">ID No.</span>
                        <P style="text-align:center; color:#973102">
                            @Model.SenderNationalId
                        </P>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.AddressType == 6 && !String.IsNullOrEmpty(Model.Item.StreetName))
                            {
                                string streetName = String.Concat("شارع: ", Model.Item.StreetName);
                                @streetName
                            }
                        </P>
                    </td>
                    <td style="border-left :0px">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyElectronic</span>
                    </td>
                    <td style="border-left:0px; border-right: 0px">
                        @if (Model.IsElectronic == true)
                        {
                            <input type="checkbox" id="inputUnchecked2" checked />
                        }
                        else
                        {
                            <input type="checkbox" id="inputUnchecked2" />
                        }
                    </td>
                    <td style="border-right:0px"><span class="pull-right">Electronic Devices</span></td>
                    <td colspan="3">
                        <span class="pull-left">العنوان</span>
                        <span class="pull-right">Address</span>
                        <P style="text-align:center; color:#973102">
                            @Model.SenderLocDesc
                        </P>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.AddressType == 6 && !string.IsNullOrEmpty(Model.Item.Description))
                            {
                                string description = String.Concat("أقرب معلم: ", Model.Item.Description);
                                @description
                            }
                        </P>
                    </td>
                    <td style="border-left :0px">
                        <span class="pull-left"> @GeneralResource.ShippmentPolicyMedicin</span>
                    </td>
                    <td style="border-left:0px; border-right: 0px">
                        @if (Model.IsMedicine == true)
                        {
                            <input type="checkbox" id="inputUnchecked2" checked />
                        }
                        else
                        {
                            <input type="checkbox" id="inputUnchecked2" />
                        }
                    </td>
                    <td style="border-right:0px"><span class="pull-right"> Medicines</span></td>
                    <td colspan="3">
                        <span class="pull-left">رقم الاتصال</span>
                        <span class="pull-right">Contact No.</span>
                        <P style="text-align:center; color:#973102">
                            @Model.SenderMobile
                        </P>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <span class="pull-left">@GeneralResource.SubUserMailbox</span>
                        <span class="pull-right">P.O.Box</span>
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.RecipientInOutTypeID == 1)
                            {
                                if (Model.Item.MailBox_POBox != 0 && Model.Item.AddressType == 1)
                                {
                                    <text>@Model.Item.MailBox_POBox</text>
                                }
                            }
                            else
                            {
                                if (Model.Item.InternationalPOBox != 0 && Model.Item.AddressType == 5)
                                {
                                    <text>@Model.Item.InternationalPOBox</text>
                                }
                            }
                        </P>
                    </td>
                    <td>
                        <span class="pull-left">الرمز البريدي</span>
                        <span class="pull-right">Postal Code</span>
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.RecipientInOutTypeID == 1)
                            {
                                if (Model.Item.MailBox_ZipCode != 0 && Model.Item.AddressType == 1)
                                {
                                    <text>@Model.Item.MailBox_ZipCode</text>
                                }
                            }
                            else
                            {
                                if (Model.Item.InternationalZipCode != 0 && Model.Item.AddressType == 5)
                                {
                                    <text>@Model.Item.InternationalZipCode</text>
                                }
                            }
                        </P>
                    </td>
                    <td style="border-left :0px">
                        <span class="pull-left"> @GeneralResource.ShippmentPolicyToys</span>
                    </td>
                    <td style="border-left:0px; border-right: 0px">
                        @if (Model.IsToyes == true)
                        {
                            <input type="checkbox" id="inputUnchecked2" checked />
                        }
                        else
                        {
                            <input type="checkbox" id="inputUnchecked2" />
                        }
                    </td>
                    <td style="border-right:0px"><span class="pull-right"> Toys</span></td>
                    <td colspan="3"></td>
                </tr>
                <tr>
                    <td colspan="3">
                        <span class="pull-left"> رقم الاتصال </span>
                        <span class="pull-right">Contact No.</span>
                        <P style="text-align:center; color:#973102">
                            @Model.Item.PhoneNumber
                        </P>
                    </td>
                    <td style="border-left :0px">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyDocuments</span>
                    </td>
                    <td style="border-left:0px; border-right: 0px">
                        @if (Model.IsDocument == true)
                        {
                            <input type="checkbox" id="inputUnchecked2" checked />
                        }
                        else
                        {
                            <input type="checkbox" id="inputUnchecked2" />
                        }
                    </td>
                    <td style="border-right:0px"><span class="pull-right"> Paper & Documents</span></td>
                    <td colspan="3"></td>
                </tr>
                <tr>
                    <td colspan="3">@GeneralResource.GeneralNationalAddress2@GeneralResource.GeneralPersonalPageRecieve </td>
                    <td style="border-left :0px">
                        <span class="pull-left">@GeneralResource.ShippmentPolicyOther </span>
                    </td>
                    <td style="border-left:0px; border-right: 0px">
                        @if (Model.IsOther == true)
                        {
                            <input type="checkbox" id="inputUnchecked2" checked />
                        }
                        else
                        {
                            <input type="checkbox" id="inputUnchecked2" />
                        }
                    </td>
                    <td style="border-right:0px"><span class="pull-right"> Other</span></td>
                    <td colspan="3">@GeneralResource.GeneralNationalAddress2@GeneralResource.GeneralPersonalPageSend </td>
                </tr>
                <tr>
                    <td>
                        <span style="display:block">رقم المبنى</span>

                        <span style="display:block">BldgNo</span>
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.RecipientInOutTypeID == 1 && Model.Item.NationalBuildingNo != 0 && Model.Item.AddressType == 2)
                            {
                                <text>@Model.Item.NationalBuildingNo</text>
                            }
                        </P>
                    </td>
                    <td colspan="2">
                        <span style="display:block"> رقم الوحدة  </span>  @*@GeneralResource.ItemPageDistrict / @GeneralResource.ShippmentPolicyStreetName*@
                        <span style="display:block">Unit No </span>
                        @*<span style="display:block">Street Name</span>*@
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.RecipientInOutTypeID == 1 && Model.Item.NationalUnitNo != 0 && Model.Item.AddressType == 2)
                            {
                                <text>@Model.Item.NationalUnitNo</text>
                            }
                        </P>
                    </td>
                    <td rowspan="2" colspan="4">
                        @if (Model.Item.RecipientInOutTypeID == 3)
                        {
                            <span class="pull-left">
                                @GeneralResource.ItemPageContentPrice (@GeneralResource.ShippmentPolicySR)
                                @if (Model.Item.ContentPrice > 0)   //20190509 show Content Price If Value > 0
                                {@Model.Item.ContentPrice}
                            </span>
                            <span class="pull-right">(Content price (SR</span>
                        }
                    </td>
                    <td>
                        <span style="display:block">رقم المبنى</span>

                        <span style="display:block">BuildingNo</span>
                        <P style="text-align:center; color:#973102">
                            @Model.SenderBuildigNo
                        </P>
                    </td>
                    <td colspan="2">
                        <span style="display:block">رقم الوحدة  </span>  @*@GeneralResource.ItemPageDistrict / @GeneralResource.ShippmentPolicyStreetName*@
                        <span style="display:block">Unit No </span>
                        @*<span style="display:block">Street Name</span>*@
                        <P style="text-align:center; color:#973102">
                            @Model.SenderUnitNo
                        </P>
                    </td>
                </tr>
                <tr>
                    <td>
                        <span class="pull-left">الرمز البريدي</span>
                        <span class="pull-right">Zip Code</span>
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.RecipientInOutTypeID == 1 && Model.Item.NationalZipCode != 0 && Model.Item.AddressType == 2)
                            {
                                <text>@Model.Item.NationalZipCode</text>
                            }
                        </P>
                    </td>
                    <td colspan="2">
                        <span class="pull-left"> الرقم الإضافي  </span>

                        <span class="pull-right"> Additional No</span>
                        <P style="text-align:center; color:#973102">
                            @if (Model.Item.RecipientInOutTypeID == 1 && Model.Item.NationalAdditionalNo != 0 && Model.Item.AddressType == 2)
                            {
                                <text>@Model.Item.NationalAdditionalNo</text>
                            }
                        </P>
                    </td>

                    <td>
                        <span class="pull-left"> الرمز البريدي</span>

                        <span class="pull-right">Zip Code</span>
                        <P style="text-align:center; color:#973102">
                            @Model.SenderZipCode
                        </P>
                    </td>
                    <td colspan="2">
                        <span class="pull-left">الرقم الإضافي  </span>

                        <span class="pull-right"> Additional No</span>
                        <P style="text-align:center; color:#973102">
                            @Model.SenderAdditionalNo
                        </P>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td colspan="2">@GeneralResource.ItemPageShipmentWeightKg</td>
                    <td> @((ViewBag.WeightInKG ?? Model.Item.Weight).ToString("F3"))</td>
                    @* or string.Format("{0:0.000}", hh) https://stackoverflow.com/questions/39012616 *@

                    <td>Weight/ kgm</td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>


                @if (Model.Item.IsCOD == true)
                {
                    <tr>
                        <td colspan="10" style="font:x-large">@GeneralResource.ContentType : @contentType    @GeneralResource.TheBill: @Model.Item.BillNumber  @GeneralResource.CollectedPrice:@Model.Item.TotalAmount</td>
                    </tr>
                }
                @if (Model.Item.IsCold == true)
                {
                    <tr>
                        <td colspan="10" style="font:x-large bold">@GeneralResource.IsCold</td>
                    </tr>
                }
                @if (Model.Item.DeliveryType == 1)
                {
                    <tr>
                        <td colspan="10" style="font:x-large bold">@GeneralResource.ExpressDelivery</td>
                    </tr>
                }

                @if (Model.Item.ReferenceId != null)
                {
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        @*<td>  @GeneralResource.ReferenceId</td>*@
                        <td colspan="2">الرقم المرجعي للمرسل</td>
                        <td>  @Model.Item.ReferenceId </td>
                        <td>  Sender Ref No</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                }
                <tr>
                    <td colspan="10" style="font:large bold">@GeneralResource.ShippingTermOffice5</td>
                </tr>
                <tr>
                    <td colspan="10" style="font:large bold">@GeneralResource.CustomerServiceNo</td>
                </tr>
            </tbody>
        </table>
    </div>
</body>
</html>

<script src="@PublishUrl/Content/SharedScripts/jquery.js"></script>
<script src="@PublishUrl/Content/SharedScripts/barcode.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function (event) {

        setTimeout(function () {
            window.print();
        }, 500);

        barcodeVal = "@barcode";
        barcodeVal = barcodeVal.toString();
        JsBarcode("#BarcodePlaceHolder", barcodeVal, {
            format: "CODE128",
            height: 30,
            font: "monospace",
            fontSize: 15,
            width: 1.5,
            displayValue: barcodeVal
        });
    });

</script>
